<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
        <title>Untitled Document</title>
        <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel="stylesheet" href="weather.css?version=2" type="text/css">
	</head>
	<body>
        <header>
            <h1>Weather</h1>
        </header>
        
        <!-- Content here -->
		<div id="container">
            <div id="part_1">
                    <script>
                            function func1(selectedLocation){
                                fetch("http://api.openweathermap.org/data/2.5/weather?q=" + selectedLocation + "&APPID=b0b9b5f8ae5db4b46ee0da30e7e4c35c") // Calling API
                             .then((response => {
                                 if(response.status !== 200) // Checking for loading failure
                                     throw new Error("Failure"); // throwing error if any
                                 
                                 return response.json(); // respond in json format
                             }))
                             .then((json) => {
                                 console.log(json); // print out json in console
                                 // ---- Printing data ----
                                 let h1 = document.createElement("h1");
                                 h1.textContent = json.name;
                                 h1.id = "part_1a";
                                 container.appendChild(h1);
                                 
                                 let p = document.createElement("p");
                                 p.textContent = "Country: " + json.sys.country;
                                 p.id = "part_1b";
                                 container.appendChild(p);
                                 
                                 let p0 = document.createElement("p");
                                 p0.textContent = "Coords: " + json.coord.lat + ", " + json.coord.lon;
                                 p0.id = "part_1c";
                                 container.appendChild(p0);
                             })
                            }
                            
                    </script>
            </div>
            <div id="part_2">
                <script>
                    function func2(selectedLocation){
                        fetch("http://api.openweathermap.org/data/2.5/weather?q=" + selectedLocation + "&APPID=b0b9b5f8ae5db4b46ee0da30e7e4c35c") // Calling API
                    .then((response => {
                        if(response.status !== 200) // Checking for loading failure
                            throw new Error("Failure"); // throwing error if any
                        
                        return response.json(); // respond in json format
                    }))
                    .then((json) => {
                        console.log(json); // print out json in console
                        // ---- Printing data ----
                        let p1 = document.createElement("p");
                        p1.textContent = "Max temp: " + json.main.temp_max;
                        p1.id = "part_2a";
                        container.appendChild(p1);
                        
                        let p2 = document.createElement("p");
                        p2.textContent = "Min temp: " + json.main.temp_min;
                        p2.id = "part_2b";
                        container.appendChild(p2);
                        
                        let p3 = document.createElement("p");
                        p3.textContent = "Pressure: " + json.main.pressure;
                        p3.id = "part_2c";
                        container.appendChild(p3);
                        
                        let p4 = document.createElement("p");
                        p4.textContent = "Humidity: " + json.main.humidity;
                        p4.id = "part_2d";
                        container.appendChild(p4);
                    })
                    }
                </script>
            </div>
            <div id="part_3">
                <script>
                    function func3(selectedLocation) {
                        fetch("http://api.openweathermap.org/data/2.5/weather?q=" + selectedLocation + "&APPID=b0b9b5f8ae5db4b46ee0da30e7e4c35c") // Calling API
                    .then((response => {
                        if(response.status !== 200) // Checking for loading failure
                            throw new Error("Failure"); // throwing error if any
                        
                        return response.json(); // respond in json format
                    }))
                    .then((json) => {
                        console.log(json); // print out json in console
                        // ---- Printing data ----                        
                        let p5 = document.createElement("p");
                        p5.textContent = "Wind speed: " + json.wind.speed;
                        p5.id = "part_3a";
                        container.appendChild(p5);

                        let p6 = document.createElement("p");
                        p6.textContent = "Wind degrees: " + json.wind.deg;
                        p6.id = "part_3b";
                        container.appendChild(p6);
                        console.log(json.wind);
                    })
                    }
                </script>
            </div>
            <div id="part_4">
                <script>
                        function func4(selectedLocation){
                            fetch("http://api.openweathermap.org/data/2.5/weather?q=" + selectedLocation + "&APPID=b0b9b5f8ae5db4b46ee0da30e7e4c35c") // Calling API
                         .then((response => {
                             if(response.status !== 200) // Checking for loading failure
                                 throw new Error("Failure"); // throwing error if any
                             
                             return response.json(); // respond in json format
                         }))
                         .then((json) => {
                             console.log(json); // print out json in console
                             // ---- Printing data ----                                                
                             let p6 = document.createElement("p");
                             p6.textContent = "Weather: " + json.weather[0].description;
                             p6.id = "part_4a";
                             container.appendChild(p6);
                         })
                        }
                </script>
            </div>
            <div id="part_5">
                <form name="changeLocationForm" id="form">
                    <h1>Change Location</h1>
                    <input type="text" name="chooseLocation" placeholder="Choose Location">
                    <input type="submit" name="submit_btn" value="Set Location">
                </form>
            </div>
        </div>
        <script>
            $(function(){
                $("#form").submit(function(e) {
                    e.preventDefault(); // Preventing refresh of website
                    let chosenLocation = document.forms["changeLocationForm"]["chooseLocation"].value; // Grabbing input value
                    
                    if(chosenLocation == "" || chosenLocation == undefined) { // checking if input is missing
                        alert("Please fill out the form"); // alert user
                    } else {
                        func1(chosenLocation); // call function
                        func2(chosenLocation); // call function
                        func3(chosenLocation); // call function
                        func4(chosenLocation); // call function
                    }
                });
            });
        </script>
    </body>
</html>
